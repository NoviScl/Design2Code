<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head>
<style></style>
   <title> [ovs-discuss] ARP issues with KVM and OVS..?
   </title>
   
   
   <meta name="robots" content="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       
           }
   </style>
   <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   
 </head>
 <body bgcolor="#ffffff">
   <h1>[ovs-discuss] ARP issues with KVM and OVS..?</h1>
    <b>Alexander Witte</b> 
    <a  title="[ovs-discuss] ARP issues with KVM and OVS..?">alexander.witte at baicanada.com
       </a><br>
    <i>Fri Jan  4 22:19:46 UTC 2019</i>
    <p></p><ul>
        <li>Previous message: <a >[ovs-discuss] Adding meter in OVS 2.10.90 Kernel-Space Switch
</a></li>
        <li>Next message: <a >[ovs-discuss] ARP issues with KVM and OVS..?
</a></li>
         <li> <b>Messages sorted by:</b> 
              <a >[ date ]</a>
              <a >[ thread ]</a>
              <a >[ subject ]</a>
              <a >[ author ]</a>
         </li>
       </ul>
    <hr>  

<pre> Hi!

Environment: KVM Fedora

I have a weird issue where a VM can ping one way through the open vswitch but the other way doesn't seem to want to go through.  The setup is like this:

VM1 --&gt; OVS --&gt; VM2. 

VM1 has two interfaces: interfaceA is tagging a VLAN in the VM.  InterfaceB has no tagging anywhere.
VM2 has two interfaces: interfaceA is being tagged (in OVS) with the same VLAN as VM1.  Interface B has no VLAN.

Interface B can ping through both ways fine.  InterfaceA can ONLY ping through Centos --&gt; Cisco.  Pinging in the other direction does not work.

We traced it to arp replies not making it back through the OVS in one direction.  Pretty weird.   I can ping one way but not the other way.  

The OVS ports are being created dynamically.  I'm defining some libvirt network XMLs that have portgroups in them that are assigned to an OVS.  Then I do a virt-install to create the VMs which places the NICs in the portgroups on the OVS.  So I create the OVS ports dynamically when the VM boots.  OVS-VSCTL show looks fine.  If needed I can paste it here (just gotta clean it up a bit since I've been experimenting).

I'm curious if this is common issue/user mistake or are there some gotchas when doing this with KVM virtual machines...?  Do these need to be hardcoded as TAP interfaces or INTERNAL interfaces.

If this is not a common problem/resolution are there any specific commands I can run to paste here to give any willing helper some more insight?

Things I've tried:
-Removing the VLAN tag.
-Separating the two interfaces to separate OpenvSwitches.

Any help is greatly appreciated!

AlexW

</pre>

    <hr>
    <p></p><ul>
        
	<li>Previous message: <a >[ovs-discuss] Adding meter in OVS 2.10.90 Kernel-Space Switch
</a></li>
	<li>Next message: <a >[ovs-discuss] ARP issues with KVM and OVS..?
</a></li>
         <li> <b>Messages sorted by:</b> 
              <a >[ date ]</a>
              <a >[ thread ]</a>
              <a >[ subject ]</a>
              <a >[ author ]</a>
         </li>
       </ul>

<hr>
<a >More information about the discuss
mailing list</a><br>

</body></html>