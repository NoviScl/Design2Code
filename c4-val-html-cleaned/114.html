<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head>
<style></style>
   <title> [PATCH 6/7] drm: add RGB formats with separate alpha plane
   </title>
   
   
   <meta name="robots" content="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       
           }
   </style>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
   
 </head>
 <body bgcolor="#ffffff">
   <h1>[PATCH 6/7] drm: add RGB formats with separate alpha plane</h1>
    <b>Ville Syrj채l채</b> 
    <a  title="[PATCH 6/7] drm: add RGB formats with separate alpha plane">ville.syrjala at linux.intel.com
       </a><br>
    <i>Wed May 20 07:07:03 PDT 2015</i>
    <p></p><ul>
        <li>Previous message: <a >[PATCH 6/7] drm: add RGB formats with separate alpha plane
</a></li>
        <li>Next message: <a >[PATCH 6/7] drm: add RGB formats with separate alpha plane
</a></li>
         <li> <b>Messages sorted by:</b> 
              <a >[ date ]</a>
              <a >[ thread ]</a>
              <a >[ subject ]</a>
              <a >[ author ]</a>
         </li>
       </ul>
    <hr>  

<pre>On Wed, May 20, 2015 at 02:58:53PM +0200, Daniel Vetter wrote:
&gt;<i> On Wed, May 20, 2015 at 12:50:35PM +0200, Philipp Zabel wrote:
</i>&gt;<i> &gt; Hi Daniel,
</i>&gt;<i> &gt; 
</i>&gt;<i> &gt; thank you for the comments.
</i>&gt;<i> &gt; 
</i>&gt;<i> &gt; Am Dienstag, den 19.05.2015, 18:52 +0200 schrieb Daniel Vetter:
</i>&gt;<i> &gt; [...]
</i>&gt;<i> &gt; &gt; &gt; @@ -5198,11 +5206,15 @@ void drm_fb_get_bpp_depth(uint32_t format, unsigned int *depth,
</i>&gt;<i> &gt; &gt; &gt;  		break;
</i>&gt;<i> &gt; &gt; &gt;  	case DRM_FORMAT_RGB565:
</i>&gt;<i> &gt; &gt; &gt;  	case DRM_FORMAT_BGR565:
</i>&gt;<i> &gt; &gt; &gt; +	case DRM_FORMAT_RGB565_A8:
</i>&gt;<i> &gt; &gt; &gt; +	case DRM_FORMAT_BGR565_A8:
</i>&gt;<i> &gt; &gt; &gt;  		*depth = 16;
</i>&gt;<i> &gt; &gt; &gt;  		*bpp = 16;
</i>&gt;<i> &gt; &gt; &gt;  		break;
</i>&gt;<i> &gt; &gt; &gt;  	case DRM_FORMAT_RGB888:
</i>&gt;<i> &gt; &gt; &gt;  	case DRM_FORMAT_BGR888:
</i>&gt;<i> &gt; &gt; &gt; +	case DRM_FORMAT_RGB888_A8:
</i>&gt;<i> &gt; &gt; &gt; +	case DRM_FORMAT_BGR888_A8:
</i>&gt;<i> &gt; &gt; &gt;  		*depth = 24;
</i>&gt;<i> &gt; &gt; &gt;  		*bpp = 24;
</i>&gt;<i> &gt; &gt; &gt;  		break;
</i>&gt;<i> &gt; &gt; &gt; @@ -5210,6 +5222,10 @@ void drm_fb_get_bpp_depth(uint32_t format, unsigned int *depth,
</i>&gt;<i> &gt; &gt; &gt;  	case DRM_FORMAT_XBGR8888:
</i>&gt;<i> &gt; &gt; &gt;  	case DRM_FORMAT_RGBX8888:
</i>&gt;<i> &gt; &gt; &gt;  	case DRM_FORMAT_BGRX8888:
</i>&gt;<i> &gt; &gt; &gt; +	case DRM_FORMAT_XRGB8888_A8:
</i>&gt;<i> &gt; &gt; &gt; +	case DRM_FORMAT_XBGR8888_A8:
</i>&gt;<i> &gt; &gt; &gt; +	case DRM_FORMAT_RGBX8888_A8:
</i>&gt;<i> &gt; &gt; &gt; +	case DRM_FORMAT_BGRX8888_A8:
</i>&gt;<i> &gt; &gt; &gt;  		*depth = 24;
</i>&gt;<i> &gt; &gt; &gt;  		*bpp = 32;
</i>&gt;<i> &gt; &gt; &gt;  		break;
</i>&gt;<i> &gt; &gt; 
</i>&gt;<i> &gt; &gt; Please drop the above two hunks, these functions are only for backwards
</i>&gt;<i> &gt; &gt; compat with drivers from the addfb1 days. Modern drivers should only use
</i>&gt;<i> &gt; &gt; the format tags directly. Extending the plane_cpp function like you do
</i>&gt;<i> &gt; &gt; below is enough.
</i>&gt;<i> &gt; 
</i>&gt;<i> &gt; I'll leave drm_fb_get_bpp_depth untouched.
</i>&gt;<i> &gt; 
</i>&gt;<i> &gt; &gt; Maybe we should add a WARN_ON(num_planes(format) != 0) to the top of this
</i>&gt;<i> &gt; &gt; and a comment that this is for legacy stuff only.
</i>&gt;<i> &gt; 
</i>&gt;<i> &gt; Do you mean:
</i>&gt;<i> &gt; 
</i>&gt;<i> &gt; -----8&lt;-----
</i>&gt;<i> &gt; --- a/drivers/gpu/drm/drm_crtc.c
</i>&gt;<i> &gt; +++ b/drivers/gpu/drm/drm_crtc.c
</i>&gt;<i> &gt; @@ -5186,6 +5186,12 @@ int drm_mode_destroy_dumb_ioctl(struct drm_device *dev,
</i>&gt;<i> &gt;  void drm_fb_get_bpp_depth(uint32_t format, unsigned int *depth,
</i>&gt;<i> &gt;  			  int *bpp)
</i>&gt;<i> &gt;  {
</i>&gt;<i> &gt; +	
</i>&gt;<i> &gt; +	WARN_ON(drm_format_num_planes(format) != 1);
</i>&gt;<i> &gt; +
</i>&gt;<i> &gt;  	switch (format) {
</i>&gt;<i> &gt;  	case DRM_FORMAT_C8:
</i>&gt;<i> &gt;  	case DRM_FORMAT_RGB332:
</i>&gt;<i> &gt; -----&gt;8-----
</i>&gt;<i> 
</i>&gt;<i> Yeah that looks perfect, please wrap with commit message&amp;sob and I'll
</i>&gt;<i> apply.
</i>
I think that's going to trigger a lot. IIRC we call this thing for
any format when constructing FBs.

-- 
Ville Syrj채l채
Intel OTC
</pre>

    <hr>
    <p></p><ul>
        
	<li>Previous message: <a >[PATCH 6/7] drm: add RGB formats with separate alpha plane
</a></li>
	<li>Next message: <a >[PATCH 6/7] drm: add RGB formats with separate alpha plane
</a></li>
         <li> <b>Messages sorted by:</b> 
              <a >[ date ]</a>
              <a >[ thread ]</a>
              <a >[ subject ]</a>
              <a >[ author ]</a>
         </li>
       </ul>

<hr>
<a >More information about the dri-devel
mailing list</a><br>

</body></html>